{% extends 'base.html' %}
{% block body %}
{# æ–‡ç« æ¨¡å— #}
<div  class="container jumbotron">
    <div id="article-page" class="">
        {# é¡¶æ å¯¼èˆªæ  #}
        <ol class="breadcrumb">
            <li><a href="{% url 'user:center' 0 1 %}"><span class="glyphicon glyphicon-home"></span></a></li>
            <li><a href="/category/PE/">PE</a></li>
            <li class="hidden-xs"><a><span class="glyphicon glyphicon-calendar"></span> {{ article.data_publish }}</a></li>
            <li><a>
                <span class="glyphicon glyphicon-eye-open"></span>
                {{ article.click_count }}
            </a></li>
            <li class="pull-right">
                <a>
                <span class="glyphicon glyphicon-user" name="blog-user"  user_id="{{ article.user.id }}"></span>
                </a>
            </li>
        </ol>

        {# å†…å®¹çš„ä¸»è¦ä¿¡æ¯ #}
        <div id="article">
            {# æ ‡é¢˜ #}
            <div class="article-title" name="article-id" article_id="{{ article.id }}" >
                <h1>{{ article.title }}</h1>
            </div>
            {# æ ‡ç­¾ è¿˜æœ‰é—®é¢˜ #}
{#            <div class="article-tags">#}
{##}
{#                <a href="/tag/PE/">#}
{#                    <span class="label label-vmaig-1 btn">PE</span>#}
{#                </a>#}
{##}
{#                <a href="/tag/%E9%80%86%E5%90%91/">#}
{#                    <span class="label label-vmaig-2 btn">é€†å‘</span>#}
{#                </a>#}
{##}
{#                <a href="/tag/%E5%8F%8D%E6%B1%87%E7%BC%96/">#}
{#                    <span class="label label-vmaig-3 btn">åæ±‡ç¼–</span>#}
{#                </a>#}
{##}
{#            </div>#}
        </div>
        <hr/>{# åˆ†è¡Œçº¿ #}

        {# ä¸»è¦å†…å®¹ #}
        <div class="article-content">
        {{ article.content | safe}}
        </div>
    </div>
    <div>
    </div>
</div>

{# è¯„è®ºæ˜¾ç¤º #}
<div class="panel panel-default">
        <div class="panel-heading">
            <h4>è¯„è®ºåˆ—è¡¨</h4>
            <button id="jump_to_comment" class="btn btn-info comment_title_btn">æˆ‘è¦è¯„è®º</button>
        </div>

        <div id="comments_list" class="panel-body">


                <div class="comment_obj" name="F340">
                    <div class="comment_user">
                        <img class="user_avatar" src="/static/media/avatar/447_64_3.jpg" alt="77">
                        <p class="uesr_name">77</p>
                    </div>

                    <div class="comment_body">
                        <div class="comment_content">
                            <p id="comment_340">æ”¯æŒä¸€ä¸‹ğŸ˜€</p>
                        </div>

                        <p class="comment_bottom">
                            <span>2019-01-23 10:19</span>
                            <span class='reply_button'>
                                <a href='javascript:void(0);' onclick='reply_click(this);' root='340' role='340' base='77'>å›å¤</a>
                            </span>
                        </p>


                        <ul class="comment_reply">

                            <li name='F341'>
                                <img class="reply_avatar" src="/static/media/avatar/447_64_3.jpg">

                                <div class="reply_body">
                                    <p>


                                            <span class="reply_name">77</span>

                                    </p>

                                    <div class="reply_content">
                                        <p id="comment_341">é¡¶ä¸€ä¸‹æˆ‘è‡ªå·±ğŸ˜€</p>
                                    </div>

                                    <p class="comment_bottom">
                                        <span>2019-01-23 10:19</span>
                                        <span class='reply_button'>
                                            <a href='javascript:void(0);' onclick='reply_click(this);' root='340' role='341' base='77'>å›å¤</a>
                                        </span>
                                    </p>
                                </div>
                            </li>

                            <li name='F342'>
                                <img class="reply_avatar" src="/static/media/avatar/447_64_3.jpg">

                                <div class="reply_body">
                                    <p>


                                            <span class="reply_name">77</span>
                                            <span> å›å¤ </span>
                                            <span class="reply_name">77</span>

                                    </p>

                                    <div class="reply_content">
                                        <p id="comment_342">è¿™ä¸ªè®²çš„å¾ˆæ£’ğŸ˜€</p>
                                    </div>

                                    <p class="comment_bottom">
                                        <span>2019-01-23 10:20</span>
                                        <span class='reply_button'>
                                            <a href='javascript:void(0);' onclick='reply_click(this);' root='340' role='342' base='77'>å›å¤</a>
                                        </span>
                                    </p>
                                </div>
                            </li>

                        </ul>

                    </div>

                    <span class="clearfix"></span>
                </div>

        </div>
    </div>

{# æ–°å»ºè¯„è®º #}
<div class="container jumbotron">
    <div id="div1" class="well-sm" >
    </div>
    <input type="button" name="input" class="btn btn-primary btn-block " id="btn_input" value="æäº¤">
</div>


{% endblock body %}
{% block bottomfiles %}
<script type="text/javascript" src="/static/js/wangEditor.min.js"></script>
<script type="text/javascript">
var E = window.wangEditor
var editor = new E('#div1')

{# jango ä¿¡æ¯è®¤è¯ #}
csrf = $('input[name=csrfmiddlewaretoken]').val()  // Djangoè®¤è¯ä¿¡æ¯

{#editor.customConfig.uploadImgShowBase64 = true   // ä½¿ç”¨ base64 ä¿å­˜å›¾ç‰‡#}
editor.customConfig.uploadImgServer = "/image"  // ä¸Šä¼ å›¾ç‰‡åˆ°æœåŠ¡å™¨
editor.customConfig.uploadFileName = 'image'
{# è‡ªå®šä¹‰å‚æ•° #}
editor.customConfig.uploadImgParams = {
    csrfmiddlewaretoken: csrf
}

{# èœå•æ é…ç½® #}
editor.customConfig.menus = [
//'head',  // æ ‡é¢˜
//'bold',  // ç²—ä½“
//'fontSize',  // å­—å·
'fontName',  // å­—ä½“
'italic',  // æ–œä½“
'underline',  // ä¸‹åˆ’çº¿
'strikeThrough',  // åˆ é™¤çº¿
'foreColor',  // æ–‡å­—é¢œè‰²
'backColor',  // èƒŒæ™¯é¢œè‰²
'link',  // æ’å…¥é“¾æ¥
//'list',  // åˆ—è¡¨
//'justify',  // å¯¹é½æ–¹å¼
'quote',  // å¼•ç”¨
'emoticon',  // è¡¨æƒ…
'image',  // æ’å…¥å›¾ç‰‡
'table',  // è¡¨æ ¼
//'video',  // æ’å…¥è§†é¢‘
'code',  // æ’å…¥ä»£ç 
'undo',  // æ’¤é”€
'redo'  // é‡å¤
]

editor.create()

// æäº¤æ–‡æœ¬å†…å®¹
document.getElementById('btn_input').addEventListener('click', function () {

    // è·å–å‚æ•°
    content = editor.txt.html()  //è¯„è®ºå†…å®¹
    article_user_id = $('span[name="blog-user"]').attr('user_id')  //è·å–æ–‡ç« ä½œè€…çš„id
    article_id = $('div[name="article-id"]').attr('article_id')
    pid = 1  //çˆ¶çº§è¯„è®ºçš„id
    alert(articleid)
    // ç»„ç»‡å‚æ•°
    params = {'content':content,'article_user_id':article_user_id, 'article_id':article_id,'pid':pid , 'csrfmiddlewaretoken': csrf}
    // å‘é€ajaxè¯·æ±‚
     $.ajax({
        url:"{% url 'public:comment' %}",
        type:'POST',
        data: params,
        processData: false,  // tell jquery not to process the data
        contentType: false, // tell jquery not to set contentType
        success: function(data) {
            if(data.res == 0){
                location.reload()
            }

        }
    }); // end ajax
}, false)

 //è¿½åŠ å†…å®¹ åœ¨ä¿®æ”¹æ–‡ä»¶æ—¶èƒ½å®¹åˆ°
editor.txt.html('')

</script>
{% endblock bottomfiles %}

